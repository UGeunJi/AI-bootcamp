#### 소수 판별법은 특정 자연수가 소수인지를 판별하는 방법입니다. 소수(prime number)는 1과 자신 이외는 약수로 가지지 않는 1보다 큰 자연수입니다. 현대 암호 기술에서 자주 사용되는 'RSA 암호'에서는 매우 큰 소수를 다루므로 '소수 판별법'이 중요한 역할을 합니다.

### 원리

3599라는 숫자가 소수인지 판별하는 예를 보도록 하겠습니다. 단순한 방법으로 3599를 2보다 큰 수로 차례대로 사용해 가면서 완전히 나누어지는지를 확인하는 방법이 있습니다. '완전히 나누어진다'는
것은 나머지를 구하는 연산인 mod 연산의 결과가 0인 것을 의미합니다. 3599의 제곱근은 59.99 $\cdots$이므로 2부터 59까지 숫자를 차례대로 mod 연산을 하면 됩니다.

실제로 mod 연산을 해보면 3599가 59로 완전히 나누어진다는 것을 알 수 있습니다. 즉, 3599는 소수가 아니라는 결과가 됩니다. 하지만 이 방법은 판별할 숫자가 클수록 연산에 많은 시간이 걸려서 현실적이지
못합니다. 이 문제를 해결하는 방법으로 '페르마 테스트(Fermat test)'가 있습니다.

페르마 테스트는 확률적 소수 판별법이라고 불리며, 어떤 수가 '소수일 가능성이 높은지'를 판별하는 것입니다. 페르마 테스트의 전제 지식이 되는 소수의 성질에 관해 설명하도록 하겠습니다.

p = 소수 <br>
n < p <br>
$n^p~ mod ~p = n$

모든 소수 p에 대해 이 식이 성립한다는 것이 증명돼 있습니다. 이것을 '페르마 소정리'라고 합니다. 페르마의 소정리를 만족하는지로 소수 판별을 하는 방법이 '페르마 테스트'입니다.

### 해설

일치하는지를 확인하는 횟수를 늘릴수록 소수일 확실성이 높아집니다. 단, p보다 작은 모든 수를 확인하려면 매우 오랜 시간이 걸립니다. 실제로는 몇 개의 수만 확인해서 소수일 가능성이 매우
높다고 판단할 수 있으면 '아마도 소수'라고 판정하고 있습니다.

예를 들어, RSA 암호에서 사용되는 소수 판별법에는 페르마 테스트를 개선한 '밀러-라빈(Miller-Rabin) 테스트'가 사용되고 있습니다. 이 방법에서는 테스트를 반복해서 소수가 아닌 확률이
0.5의 80승보다 작은 단계에서 해당 수를 소수라고 판별합니다.

### 보충

조사 대상인 숫자 p가 소수인 경우, p보다 작은 숫자 n은 모두 $n^p~ mod~p = n$을 만족합니다. 단, 모든 n이 이 식을 만족한다고 해서 소수라고 할 수는 없습니다. 왜냐하면, 아주 작은 확률일지라도
모든 n이 식을 만족하는 합성수(소수가 아닌 자연수)가 존재하기 때문입니다. 이런 합성수를 '카마이클 수(Carmichael number)' 또는 '절대 유사소수(absolute pseudoprimes)'라고 합니다.
카마이클 수를 작은 것부터 차례로 나열한 것이 아래의 그림으로, 많지 않다는 것을 알 수 있습니다.

| 561 | 1105 | 1729|
| --- | --- | --- |
| 2465 | 2821 | 6601 |
| 8911 | 10585 | 15841 |
| 29341 | 41041 | 46657 |
| 52633 | 62745 | 63973 |

### 토막 지식
입력 길이가 다항식 오더인 알고리즘으로 소수 판별이(확률적이 아닌 결정론적) 가능한지는 오랫동안 풀지 못한 난제였습니다. 하지만 2002년에 인도의 수학자 3인이 가능하다는 것을
증명했습니다. 이 판별 방법은 고안자의 머리글자를 따서 'AKS 소수 판별법'이라고 합니다. 다항식 오더라고 하지만, 차수가 높기 때문에 페르마 테스트처럼 계산 속도가 빠른 방법이 주로 사용되고 있습니다.
