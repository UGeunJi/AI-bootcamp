#### 이 절에서 설명하는 전자 인증서를 이용하면 공개키의 정당성을 보장할 수 있게 됩니다.

### 원리

1. A는 공개키와 비밀키 쌍을 가지고 있으며, 공개키를 B에게 전달하려고 합니다. A는 먼저 인증 기관(CA: Certification Authority)에 공개키가 자신의 것임을 나타내는 인증서 발행을 의뢰합니다.

2. A는 공개키와 비밀키를 보유하고 있는 인증 기관에 공개키와 메일 주소를 포함한 개인 정보를 보냅니다.

3. 인증 기관은 받은 정보가 틀림 없이 A라는 것을 확인합니다. 확인을 완료하면 인증 기관의 비밀키를 이용해서 A의 데이터로부터 전자 서명을 작성합니다. 작성한 전자 서명과 데이터를 하나의 파일로 만들고 A에게 보냅니다.

---

### 원 포인트

인증 기관은 전자 서명을 관리하기 위한 조직입니다. 원론상으로는 누구든 인증 기관을 만들 수 있어서 많은 기관이 존재합니다. 따라서 정부나 외부 기관을 통해 감사를 받은 대기업 등 신뢰할 수 있는 기관을 이용하는 것이 안전합니다.

---

4. 이 파일은 A의 전자 인증서가 됩니다. A는 공개키 대신 전자 인증서를 B에게 보냅니다.

5. B는 받은 인증서에 적힌 메일 주소가 A의 것인지 확인합니다. 계속해서 B는 인증 기관의 공개키를 취득합니다. B는 인증서 내의 서명이 인증 기관의 것인지 검증하는데 인증서의 서명은 인증 기관의 공개키로만 검증할 수 있습니다.
검증 결과에 문제가 없다면 이 인증서는 인증 기관이 발행한 것이 보장됩니다.

6. 인증서가 인증 기관에서 발행된 것이고 A의 것임이 확인됐으므로 인증서에서 A의 공개키를 꺼냅니다. 이것으로 A로부터 B에게로의 공개키 전달이 완료됩니다.

### 안전성 검증

제3자가 A로 위장해서 B에게 공개키를 전달해도 B는 인증서로 전달되지 않은 공개키를 신뢰할 필요가 없습니다.

제3자가 A로 위장해서 인증 기관에 자신의 공개키를 등록하려고 해도 A의 메일 주소를 소유하고 있지 않아서 인증서를 발급받을 수 없습니다.

### 해설

전자 인증서를 사용해서 공개키 작성자를 확인할 수 있다는 것을 보았습니다. 그런데 B가 받은 공개키는 정말 인증 기관이 발급한 것일까요?

공개키 자체는 작성자를 확인할 수단이 없으므로 인증 기관으로 위장한 제3자가 작성할 것일 수도 있습니다. 즉, **공개키가 가진 문제가 동일하게 발생하는 것입니다.**

**실은 이 인증 기관의 공개키도 전자 인증서로 전달됩니다.** 그렇다면 이 인증 기관의 인증서에는 **누가 서명**하는 것일까요? **더 상위에 있는 인증 기관**입니다.

인증 기관은 트리 구조로 되어 있으며, 상위의 인증 기관이 하위 인증 기관의 인증서를 작성합니다. 신뢰가 부족한 새로 설립된 회사 B가 인증 기관을 하고 싶어도 신용도가 없습니다.
그래서 B는 A사에게 전자 인증서를 발급받습니다. A사는 B사가 인증 기관 업무를 적절히 수행하고 있는지 감독합니다. 인증서가 발행되면 B사는 A사의 신뢰를 받고 있는 회사라고 어필할 수 있습니다.
이처럼 더 큰 조직이 작은 조직의 신뢰를 담보하는 형태로 트리 구조가 형성됩니다.

최상위에 있는 인증 기관은 '최상위 인증 기관(Root CA)'이라고 하며, 자신의 정당성을 스스로 증명하게 됩니다. 참고로, 최상위 인증 기관이 스스로 인증하는 인증서는 '최상위 인증서'라고 합니다.
최상위 인증서는 기관 자체가 신뢰받지 못하면 이용할 수가 없습니다. 따라서 대기업이나 정부 관련 기관 등 이미 사회적으로 신뢰를 얻고 있는 기관이 많습니다.

### 보충

지금까지 개인 간의 공개키 교환 흐름을 다뤘지만, 웹사이트와 통신할 때에도 전자 인증서가 사용됩니다. 웹사이트로부터 공개키가 붙은 인증서를 받으면 해당 사이트가 제3자에 의해 위장되지 않은 것을 확인할 수 있습니다.

이 인증서는 '서버 인증서'라고 하는 것으로, 인증 기관에 의해 발행됩니다. 개인의 경우 인증서는 메일 주소와 연결되지만, 서버 인증서는 도메인과 연결됩니다. 즉, 웹사이트의 도메인을 관리하는 조직과
웹사이트의 내용이 담긴 서버를 관리하는 조직이 같음을 확인할 수 있습니다.

이처럼 전자 인증서는 인증 기관을 통해서 공개키 작성자를 보증하는 사회적 구조입니다. 이와 같은 일련의 구조를 '공개키 기반(Public Key Infrastructure: PKI)'이라고 합니다.
