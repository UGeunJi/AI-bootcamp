#### 디피-헬만 키 교환법(Diffie-Hellman key exchange)은 양자 간에 안전하게 키를 교환하기 위한 기법입니다. 두 명이 공유하는 비밀의 수를 공개된 수와의 연산에 사용해서 양자 간의 공통 키를 안전하게 교환할 수 있습니다.

### 특징

- 두 개의 키를 합성하는 특별한 방법이 있다고 가정해 보겠습니다. 이 합성 방법으로 키 P와 키 S를 합성하면 새로운 키 P-S가 만들어집니다.
- 이 합성 방법에는 세 가지 특성이 있습니다.

1. 키 P와 그것을 이용해서 합성한 키 P-S가 있다 해도 키 S를 추출하는 것은 불가능하다.
2. 합성된 키를 새로운 키와 합성할 수 있다. 키 P-S를 이용해서 새로운 키 P-P-S가 만들어집니다.
3. 합성 결과는 순서에 상관없으며, 어떤 키를 사용했는지가 중요합니다.

### 원리

1. A와 B 사이에 키를 안전하게 교환. 먼저 A가 키 P를 준비합니다. 다음은 A와 B가 각각 비밀키 SA와 비밀키 SB를 준비합니다. 키 SA와 키 SB는 제3자가 모르게 관리해야 합니다.

2. A는 키 P와 비밀키 SA로부터 새로운 키 P-SA를 합성하고, B는 키 P와 비밀키 SB로부터 새로운 키 P-SB를 합성합니다.

3. 각자 합성한 키를 서로 교환합니다. 교환한 키에 각자 가지고 있던 비밀키 SA와 비밀키 SB를 추가해서 합성합니다. 그러면 모두 키 P-SA-SB를 가지게 되는 것입니다. 이 키를 암호키, 복호키로 사용할 수 있습니다.

---

### 안전성 검증

키 P, 키 P-SA, 키 S-SB는 인터넷을 경유해서 전송되기 때문에 제3자가 훔쳐볼 가능성이 있습니다. 하지만 이 키들은 분해 및 추출이 불가능합니다. 따라서 아무리 합성을 해도
키 P-SA-SB가 나올 수 없는 것입니다.

---

### 수식 표현

수식에서는
키 P -> P와 G라는 두 개의 정수로 표현됩니다. **P는 매우 큰 소수이고, G는 소수 P에 대응하는 '생성자'**(또는 원시근(primitive root))라고 하는 숫자로부터 하나 선택합니다.

1. 먼저, A가 소수 P와 생성자 G를 준비하고 B에게 전달합니다. 제3자에게 노출되어도 상관없습니다.

2. 다음은 A와 B가 비밀값 X와 Y를 준비합니다. **비밀값 X와 Y는 P-2보다 작아야 합니다.**

3. A와 B는 '(G를 비밀값으로 제곱) mod P'를 계산합니다. mod는 나눗셈의 나머지를 구하는 연산입니다. 이 계산이 이론상의 '합성'에 해당합니다.

4. A와 B는 계산 결과를 서로 교환합니다. 각자 서로에게서 받은 수를 자신의 비밀키로 제곱하고 mod P를 계산합니다. A와 B의 계산 결과가 같다는 것을 알 수 있습니다. 이로써 암호의 키로 사용할 수 있는 숫자를 공유하게 됩니다.

---

### 안전성 검증

제3자가 통신을 훔쳐본다고 해도 발견한 숫자로 A와 B가 공유하는 숫자를 계산할 수 없습니다. 또한, 비밀값 X나 Y를 구하는 것도 불가능합니다. 따라서 디피-헬만 키 교환법은 이 상태에서는 안전하다고 볼 수 있습니다.

---

### 해설

디피-헬만 키 교환법은 Diffie와 Hellman이 고안한 것입니다. 이 둘은 2015년에 튜링상을 받았습니다.

소수 P, 생성자 G, G의 X승 mod P로부터 X를 구하는 문제는 '이산대수 문제'라고 불리며, 아직 효율적인 해법이 발견되지 않은 상태입니다. 디피-헬만 키 교환법은 이 수학적 난제를 이용한 키 교환법이라고 할 수 있습니다.

### 보충

디피-헬만 키 교환법은 공개해도 좋은 정보를 양자 간에 교환되는 기법입니다. 실제로는 키를 교환하는 것이 아니라 생성하고 있는 것입니다. 이 때문에 '디피-헬만 키 합의(Diffie-Hellman Key Agreement)'라고도 불립니다.
