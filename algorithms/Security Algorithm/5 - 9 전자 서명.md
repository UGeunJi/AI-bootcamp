#### 전자 서명은 메시지 인증 코드가 가지는 '인증'과 '변조 검출' 두 가지 기능에 '부인 방지'를 추가한 것입니다.

### 원리

A가 B에게 메시지를 보내려고 합니다. 이때 A만 작성할 수 있는 전자 서명을 첨부합니다. 이렇게 하면 전송자가 A인 것이 보장됩니다.
B는 전자 서명의 정당성을 검증할 수 있지만, 전자 서명을 작성할 수는 없습니다.

전자 서명의 작성 방법을 구체적으로 살펴보겠습니다. 전자 서명의 작성 순서는 '공개키 암호 방식'의 순서를 응용하고 있습니다.

1. 전자 서명에서는 공개키 암호 방식을 역으로 사용합니다. A가 전송하고 싶은 메시지와 비밀키, 공개키를 준비합니다. 전송측이 모든 키를 준비하는 점이 공개키 암호 방식과 다릅니다.

2. A는 B에게 공개키를 전달합니다. A는 비밀키를 사용해서 메시지를 암호화합니다. 이것이 전자 서명입니다.

3. A는 메시지와 서명을 B에게 전송합니다. B는 공개키를 사용해서 암호문(서명)을 복호화합니다. 이 메시지가 받은 메시지와 일치하는지 확인하고 데이터 교환이 마무리됩니다.

### 해설

이 암호문의 작성자가 비밀키를 가진 A라는 것이 보장됩니다. '전자 서명'에서는 이 A만이 만들 수 있는 암호문을 '서명'으로 활용합니다.

참고로, 공개키 암호 방식에서는 공개키로 암호화한 것을 비밀키로 복호화하면 원래 값으로 되돌릴 수 있었습니다. 이 절에서 설명한 전자 서명에서는 비밀키로 암호화한 것을 공개키로 복호화하면 원 메시지와
같아진다는 성질을 이용하고 있습니다. 즉, 키를 사용하는 순서를 바꿔도 같은 방식으로 동작하는 것입니다. 모든 공개키 암호 방식이 이 성질을 가지는 것은 아니지만, 예를 들어 RSA 암호 방식은 이 성질을 만족합니다.

A의 공개키로 복호화할 수 있는 암호문은 A 본인만 만들 수 있는 것입니다. 이 때문에 메시지를 전송한 것이 A라는 것과 메시지가 변조되지 않았다는 것을 판단할 수 있습니다.
또한, A의 서명은 공개키만 가진 B는 작성할 수 없으므로 부인 방지 역할도 하게 됩니다.

### 보충

공개키 암호 방식은 암호화와 복호화 모두 시간이 걸리는 경향이 있습니다. 계산 시간을 단축하기 위해 실제로는 메시지를 직접 암호화하는 것이 아니라 먼저 메시지의 해시값으 구한 후 그것을 암호화해서 서명으로 사용합니다.

'인증', '변조 검출', '부인 방지' 기능을 모두 갖춘 전자 서명이지만 한 가지 문제가 있습니다.

B는 전자 서명을 이용한 데이터를 교환해서 메시지 전송자가 A라고 믿고 있지만, 실제로는 A로 가장한 X와 데이터를 주고 받을 가능성이 존재합니다. 그 근본적인 원인은 공개키 암호 방식에서 공개키가 누구 것인지 알 수 없다는 데 있습니다.
받은 공개키에는 작성자를 가리키는 정보가 하나도 포함돼 있지 않습니다. 따라서 A로 가장한 누군가가 공개키를 작성할 가능성도 있습니다.

이 문제는 다음 절에서 설명하는 '전자 인증서'로 해결할 수 있습니다.
